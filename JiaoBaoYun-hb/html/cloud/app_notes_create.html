<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="../../css/utils/common.css" />
		<script src="../../js/mui.min.js"></script>
		<script type="text/javascript" src="../../js/publicProtocol.js"></script>
		<script type="text/javascript" src="../../js/utils/events.js"></script>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">笔记</h1>
			<a id="finish" class="mui-pull-right">完成</a>
		</header>
		<div class="mui-content">
			<div>
				<div class="mui-input-row" style="margin: 5px;">
					<textarea id="notes" maxlength="2000" rows="10" placeholder="请输入内容"></textarea>
				</div>
			</div>
		</div>
		<script type="text/javascript">
			mui.init();
			mui.plusReady(function() {
				var note = document.getElementById("notes");
				document.getElementById('finish').addEventListener('tap', function() {
					if(note.value.replace(/(^\s*)|(\s*$)/g, "") == "") { //为空不允许发送
						mui.toast('请输入文字');
					} else {
						var userId = window.myStorage.getItem(window.storageKeyName.PERSONALINFO).utid;

						//38.（用户空间）新增某用户空间信息 （云笔记）
						//所需参数
						var comData = {
							userId: userId, //用户ID
							msgContent: note.value, //记事内容
							encType: '3', //附件类型，1图片2音视频3仅文字
							encAddr: '', //附件地址
							encImg: '', //附件缩略图地址
							encIntro: '', //附件简介
							noteType: '1', //信息类型,1云笔记2个人空间
							userIds: '[]' //推送用户ID
						};
						//非0为正确
						// 等待的对话框
						var wd = plus.nativeUI.showWaiting(storageKeyName.WAITING);
						postDataPro_addUserSpace(comData, wd, function(data) {
							wd.close();
							console.log('38postDataPro_addUserSpace（用户空间）新增某用户空间信息 （云笔记）.90909090success:RspCode:' + data.RspCode + ',RspData:' + JSON.stringify(data.RspData) + ',RspTxt:' + data.RspTxt);
							if(data.RspCode == 0) {
								events.fireToPageNone('app_notes_sub.html','refresh');
								mui.back();
							} else {
								if(data.RspCode != 9) {
									mui.toast(data.RspTxt);
								}
							}
						});
					}
				})
			})
		</script>
	</body>

</html>