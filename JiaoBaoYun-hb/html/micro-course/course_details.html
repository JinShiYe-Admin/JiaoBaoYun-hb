<!--
	作者：444811716@qq.com
	时间：2017-06-02
	描述：课程详情列表
-->
<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="../../css/utils/common.css" />
		<link rel="stylesheet" href="../../css/iconfont/iconfont.css" />
		<link rel="stylesheet" href="../../css/utils/pullToRefresh.css" />
		<style>
			body,
			.mui-content {
				word-wrap: break-word;
			}

			.mui-table-view:before,
			.mui-table-view:after,
			.course-top .mui-table-view-cell:after,
			.course-comment .mui-table-view-cell:after {
				height: 0px;
			}

			.mui-table-view-cell.mui-collapse.mui-active {
				margin-top: 0;
			}

			.course-top .mui-navigate-right {
				width: 21px;
				height: 21px;
				position: absolute;
				right: 10px;
			}

			.course-top .mui-navigate-right:after {
				content: "\e581";
				right: 5px;
			}

			.mui-collapse {
				padding: 0px;
			}

			.mui-table-view-cell.mui-collapse .mui-collapse-content {
				margin: 0px;
				padding: 11px 15px;
				padding-top: 0px;
			}

			.mui-collapse-content {
				font-size: 14px;
				color: #808080;
			}

			.course-top .mui-table-view-cell>a:not(.mui-btn).mui-active,
			.course-top .mui-table-view-cell.mui-active,
			.course-comment .mui-table-view-cell.mui-active {
				background-color: white;
			}

			.mui-bar-tab button {
				/*评论按钮*/
				text-align: left;
				padding: 6px 12px 7px !important;
				color: #CCCCCC;
				margin: 10px 3% !important;
				width: 94%;
				top: 0 !important;
			}

			.course-title {
				font-size: 16px;
				color: #323232;
			}

			.course-top .course-title {
				margin-right: 15px;
			}

			.course-list .course-title {
				margin-bottom: 11px;
			}

			.course-info,
			.course-comment-info {
				color: #B7B7B7;
				font-size: 14px;
			}

			.course-top .course-info {
				margin-top: -11px !important;
			}

			.course-info .mui-pull-right {
				display: inline;
			}

			.icon-zanzan1 {
				font-size: 13px;
				color: #B7B7B7;
			}

			.course-more {
				text-align: center;
				color: #B7B7B7;
				font-size: 14px;
			}

			.course-more .mui-icon-arrowdown {
				font-size: 14px;
			}

			.course-list {
				margin-top: 8px;
			}

			.course-list-li {
				display: flex;
				justify-content: center;
				align-items: center;
			}

			.course-list-li-left {
				width: 60%;
			}

			.course-list-img-div {
				float: right;
				overflow: hidden;
				width: 40%;
				line-height: 0px;
			}

			.course-list-img {
				/*课程列表图片的*/
				visibility: hidden;
				width: 100%;
			}

			.course-image-play-div {
				position: absolute;
				right: 15px;
				background-color: rgba(0, 0, 0, 0.5);
				visibility: hidden;
			}

			.course-image-play {
				/*视频播放按钮*/
				width: 55px;
				height: 55px;
			}

			.course-comment-info,
			.course-comment-reply-info,
			.course-comment-reply-content {
				display: inline;
			}

			.course-comment-title {
				/*评论栏标题*/
				background-color: #F2F2F2;
				padding: 10px;
				border-left: 3px solid #1DB8F1;
				font-size: 15px;
				color: #323232;
			}

			.course-comment-personal-headimage {
				/*评论者头像*/
				width: 40px;
				height: 40px;
				border-radius: 50%;
				float: left;
				margin-right: 10px;
			}

			.course-comment .icon-zanzan1 {
				/*评论点赞按钮*/
				float: right;
				line-height: 40px;
				margin-left: 30px;
			}

			.course-comment-personal-name {
				/*评论者昵称*/
				font-size: 15px;
				color: #323232;
				line-height: 40px;
			}

			.course-comment-content {
				/*评论的内容*/
				margin: 11px 0;
				color: #808080;
				font-size: 14px;
			}

			.course-comment-reply {
				/*评论回复区域*/
				font-size: 14px;
				background-color: #F2F2F2;
				padding: 5px;
				margin-top: 11px;
			}

			.course-comment-reply-name {
				/*回复者的名称*/
				display: inline;
				color: #1DB8F1;
				font-size: 14px;
			}

			.course-comment-reply-all {
				/*查看所有回复*/
				color: #1DB8F1;
				font-size: 14px;
			}

			.course-comment-reply-content {
				font-size: 14px;
				color: #808080;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 id="title" class="mui-title"></h1>
			<a id="introduction" class="mui-icon mui-icon-person mui-pull-right"></a>
		</header>
		<nav class="mui-bar mui-bar-tab">
			<a class="mui-tab-item">
				<button type="button" class="mui-btn mui-btn-block mui-btn-outlined">请输入评论</button>
			</a>
		</nav>
		<div class="mui-content mui-scroll-wrapper" style="z-index: 1;">
			<div class="mui-scroll">
				<ul class="mui-table-view course-top">
					<li class="mui-table-view-cell">
						<div id="collapse_content_show" class="mui-navigate-right"></div>
						<div id="course_title_first" class="course-title">
							一二三四五六七八九十一二三四五六七八九十
						</div>
					</li>
					<li id="collapse_content_li" class="mui-table-view-cell mui-collapse">
						<div class="mui-collapse-content">
							一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十
						</div>
					</li>
					<li class="mui-table-view-cell course-info">
						<div class="mui-icon iconfont icon-zanzan1">(20)</div>
						<div class="mui-pull-right">上传时间:2017-6-1</div>
					</li>
				</ul>
				<ul class="mui-table-view course-list">
					<li class="mui-table-view-cell">
						<div class="course-title">
							音频
						</div>
						<div id="SVG">
							<svg style="width: 100%;height: 50px;">
								<path d="M8 45 C13 40 15 38 15 25 L15 21 Q15 1 36 1 L300 1 Q325 1 325 21 Q325 41 300 41 L30 41 Q15 41 12 43 L8 45 Z" style="stroke:#1DB8F1; fill:none;" />
								<path d="M30 18 A5 5 0 0 1 30 23 M35 14 A10 10 0 0 1 35 27 M40 10 A 15 15 0 0 1 40 31" style="stroke:#B7B7B7; fill:none;stroke-width: 2px;" />
								<text x="60" y="26" fill="#B7B7B7" font-size="15">120''</text>
							</svg>
						</div>
						<div class="course-info">上传时间:2017-6-1</div>
					</li>
					<li class="mui-table-view-cell">
						<div class="course-title">
							文字一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十
						</div>
						<div class="course-info">上传时间:2017-6-1</div>
					</li>
					<li class="mui-table-view-cell course-list-li">
						<div class="course-list-li-left">
							<div class="course-title">
								图片
							</div>
							<div class="course-info">上传时间:2017-6-1</div>
						</div>
						<div class="course-list-img-div">
							<img id="course-image-1" class="course-list-img" onload="onImageLoad(this);" onerror="onImageError(this);" />
						</div>
					</li>
					<li class="mui-table-view-cell course-list-li">
						<div class="course-list-li-left">
							<div class="course-title">
								视频
							</div>
							<div class="course-info">上传时间:2017-6-1</div>
						</div>
						<div class="course-list-img-div">
							<div class="course-image-play-div">
								<img id="course-image-play" class="course-image-play" onload="onPlayLoad(this);" onerror="onPlayError(this);" />
							</div>
							<img id="course-image-2" class="course-list-img" onload="onImageLoad(this);" onerror="onImageError(this);" />
						</div>
					</li>
					<li id="course_more" class="mui-table-view-cell course-more">
						查看更多
						<div class="mui-icon mui-icon-arrowdown"></div>
					</li>
				</ul>
				<div class="course-comment-title">
					评论(100)
				</div>
				<ul class="mui-table-view course-comment">
					<li class="mui-table-view-cell">
						<img src="../../image/dynamic/u101.png" class="course-comment-personal-headimage" />
						<div class="mui-icon iconfont icon-zanzan1">(20)</div>
						<div class="mui-ellipsis course-comment-personal-name">一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十</div>
						<div class="course-comment-content">一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十</div>
						<div class="course-comment-info">回复100</div>
						<div class="mui-pull-right course-comment-info">2017-6-2</div>
						<div class="course-comment-reply">
							<div>
								<div class="course-comment-reply-name">1234</div>
								<div class="course-comment-reply-info">@</div>
								<div class="course-comment-reply-name">4321</div>
								<div class="course-comment-reply-info">:</div>
								<div class="course-comment-reply-content">
									一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十
								</div>
							</div>
							<div>
								<div class="course-comment-reply-name">1234</div>
								<div class="course-comment-reply-info">@</div>
								<div class="course-comment-reply-name">4321</div>
								<div class="course-comment-reply-info">:</div>
								<div class="course-comment-reply-content">
									一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十
								</div>
							</div>
							<div class="course-comment-reply-all">查看全部>></div>
						</div>
					</li>
				</ul>
			</div>
		</div>
		<script src="../../js/mui.min.js"></script>
		<script type="text/javascript" src="../../js/utils/events.js"></script>
		<script type="text/javascript" src="../../js/utils/playutil.js"></script>
		<script type="text/javascript" src="../../js/mui.pullToRefresh.js"></script>
		<script type="text/javascript" src="../../js/mui.pullToRefresh.material.js"></script>
		<script type="text/javascript">
			var pullRefresh; //上拉加载控件
			var page = {
				pageIndex: 0,
				totalPage: 0
			}; //评论的页数

			mui.init();
			mui.plusReady(function() {
				console.log(plus.screen.resolutionWidth)
				document.getElementById("course-image-1").src = "../../image/cloud/notes_bg2.jpg";
				document.getElementById("course-image-2").src = "../../image/ios_1242-2208.png";
				document.getElementById("course-image-play").src = "../../image/utils/playvideo.png";
				//				document.getElementById("SVG").innerHTML = '<svg style="width: 100%;height: 50px;">\
				//								<path d="' + getAudioPath(250) + '" style="stroke:#1DB8F1; fill:none;" />\
				//								<path d="M20 25 L30 25" style="stroke:#E4E4E4; fill:none;" />\
				//							</svg>';
				initControl();
				initListener();
			});

			/**
			 * 初始化控件
			 */
			function initControl() {
				//初始化下拉，上拉控件
				var deceleration = mui.os.ios ? 0.003 : 0.0009;
				mui('.mui-scroll-wrapper').scroll({
					bounce: false,
					indicators: true, //是否显示滚动条
					deceleration: deceleration
				});
				pullRefresh = mui('.mui-scroll-wrapper .mui-scroll').pullToRefresh({
					up: {
						contentinit: '', //默认没有更多显示空白
						contentnomore: '', //隐藏没有更多提示
						callback: function() {
							console.log('up ' + JSON.stringify(page));
							if(page) {
								//requestData(page.pageIndex + 1);
							} else {
								mui.toast('数据异常，请下拉刷新后重新尝试');
							}
							setTimeout(function() {
								endPullUp();
							}, 1000);
						}
					}
				});
			}

			/**
			 * 初始化监听
			 */
			function initListener() {

				//显示课程简介
				document.getElementById('collapse_content_show').addEventListener('tap', function() {
					var collapse_content_li = document.getElementById("collapse_content_li");
					var classNameList = collapse_content_li.className.split(" ");
					var show = false;
					for(var i in classNameList) {
						if(classNameList[i] == "mui-active") {
							show = true;
							break;
						}
					}
					if(show) {
						collapse_content_li.className = "mui-table-view-cell mui-collapse";
					} else {
						collapse_content_li.className = "mui-table-view-cell mui-collapse mui-active";
					}
				});

				//课程介绍
				document.getElementById('introduction').addEventListener('tap', function() {
					var data = {
						"TabId": 1,
						"SecId": 1,
						"SecName": "荷塘月色",
						"CourseName": "语文",
						"SecStatus": 1,
						"IsFocus": 0,
						"CoursePic": "aa"
					}
					events.openNewWindowWithData('course-introduction.html', data);
				});
			}

			/**
			 * 结束上拉加载更多
			 */
			function endPullUp() {
				if(page && page.pageIndex >= page.totalPage) {
					console.log('没有下一页');
					pullRefresh.endPullUpToRefresh(true);
				} else {
					pullRefresh.endPullUpToRefresh();
				}
			}
			/**
			 * 课程列表中的图片加载成功
			 * @param {Object} img
			 */
			function onImageLoad(img) {
				img.parentNode.style.height = parseInt(img.offsetWidth * (3 / 4)) + "px";
				if(img.offsetWidth > img.offsetHeight) { //宽的图片
					img.style.height = img.parentNode.offsetHeight + "px";
					img.style.width = "initial";
					img.style.marginLeft = parseInt(img.offsetWidth * 0.5 - img.parentNode.offsetWidth * 0.5) * (-1) + 'px';
				} else { //高的图片
					img.style.marginTop = parseInt(img.offsetHeight * 0.5 - img.parentNode.offsetHeight * 0.5) * (-1) + 'px';
				}
				img.style.visibility = "visible";
			}

			/**
			 * 课程列表中的图片加载失败
			 * @param {Object} img
			 */
			function onImageError(img) {
				img.style.visibility = "visible";
			}

			/**
			 * 视频播放按钮加载失败
			 * @param {Object} img
			 */
			function onPlayError(img) {
				img.parentNode.style.visibility = "visible";
			}

			/**
			 * 视频播放按钮加载成功
			 * @param {Object} img
			 */
			function onPlayLoad(img) {
				var width = img.parentNode.parentNode.offsetWidth;
				var height = parseInt(width * (3 / 4));
				img.parentNode.style.width = width + "px";
				img.parentNode.style.height = height + "px";
				img.parentNode.style.visibility = "visible";
				img.style.marginLeft = parseInt((width - 55) / 2) + "px";
				img.style.marginTop = parseInt((height - 55) / 2) + "px";
			}

			function getAudioPath(width) {
				width = width || plus.screen.resolutionWidth;
				width = parseInt(width * 2 / 3);
				var pathD = "M8 45 C13 40 15 38 15 25 L15 21 Q15 1 36 1 L" + width + " 1 Q" + (width + 25) + " 1 " + (width + 25) + " 21 Q" + (width + 25) + " 41 " + width + " 41 L30 41 Q15 41 12 43 L8 45 Z"
				return pathD;
			}
		</script>
	</body>

</html>