<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link href="../../css/utils/common.css" rel="stylesheet" />
		<link href="../../css/iconfont/iconfont.css" rel="stylesheet" />
		<link href="../../css/homework/publish-answer.css" rel="stylesheet" />
		<link href="../../css/iconfont/iconfont.css" rel="stylesheet" />
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
		    <h1 class="mui-title">上传答案||作业</h1>
		    <a id="getAnswer" class="mui-icon iconfont icon-xiangji mui-pull-right"></a>
		</header>
		<div class="mui-content">
		    <form class="mui-input-group">
		        <div class="mui-input-row">
		            <label>科目:</label>
		            <select>
		            	<option>语文</option>
		            	<option>数学</option>
		            	<option>英语</option>
		            	<option>历史</option>
		            	<option>政治</option>
		            	<option>地理</option>
		            	<option>物理</option>
		            	<option>化学</option>
		            	<option>生物</option>
		            	<option>其他</option>
		            </select>
		        </div>
		         <p style="text-align: center;">请上传答案图片，以供学生参考</p>
		        <div id="pictures">
		        	
		        </div>
		       
		    </form>
		    <button  id='post-imgs' class="mui-btn mui-btn-blue btn-publish">上传作业</button>
		</div>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/utils/events.js"></script>
		<script src="../../js/utils/camera.js"></script>
		<script src="../../js/utils/load.js"></script>
		<script src="../../js/mui.zoom.js"></script>
		<script src="../../js/mui.previewimage.js"></script>
		<script type="text/javascript">
			mui.init({
				//手势事件配置
				gestureConfig:{
					longtap:true//长按事件 可监听
				}
			})
			mui.plusReady(function(){
				mui.previewImage();
				var pictures=document.getElementById('pictures');
				//获取图片
				events.addTap('getAnswer',function(){
					camera.getPic(camera.getCamera(),function(picPath){
						var div=document.createElement('div');
						div.className='img-div';
						div.innerHTML='<img src="'+picPath+'" data-preview-src="" data-preview-group="1"/>'
										+'<a class="mui-icon iconfont icon-guanbi"></a>'
						pictures.appendChild(div);
					})
				})
				//获取图片显示控件
				var pictures=document.getElementById('pictures');
				//图片长按事件
				mui('#pictures').on('longtap','.img-div',function(){
					mui.each(document.querySelectorAll('.icon-guanbi'),function(index,item){
						//显示图标
						item.style.display='block';
					})
				})
				//删除图标的点击事件
				mui('#pictures').on('tap','.icon-guanbi',function(){
					//删除图片
					pictures.removeChild(this.parentElement)
					//获取路径
					var path=this.parentElement.querySelector('img').src;
					//在数组中删除图片路径
					camera.imgPaths.splice(camera.imgPaths.indexOf(path));
				})
				//上传路径
				var server="http://demo.dcloud.net.cn/helloh5/uploader/upload.php";
				//上传按钮点击事件
				events.addTap('post-imgs',function(){
					if(camera.imgPaths.length>0){
						load.createUpload(server,camera.imgPaths);
					}else{
						mui.toast('请拍照后上传')
					}
				})
			})
			
		</script>
	</body>

</html>