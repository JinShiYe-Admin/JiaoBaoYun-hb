<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../css/mui.min.css">
		<link rel="stylesheet" href="../css/home/index-menu.css" />
		<link rel="stylesheet" href="../css/iconfont/iconfont.css" />

		<style type="text/css">
			.title {
				margin: 35px 15px 10px;
			}

			.title+.content {
				margin: 10px 15px 35px;
				color: #bbb;
				text-indent: 1em;
				font-size: 14px;
				line-height: 24px;
			}

			.mui-table-view {
				margin-bottom: 35px;
			}
		</style>
	</head>

	<body>
		<div class="mui-content">
			<ul class="mui-table-view">
			    <li id="title" class="mui-table-view-cell mui-media">
			        <a href="javascript:;">
			            <img id="uimg" class="mui-media-object mui-pull-left" src="../image/slide_navigation/img3.jpg">
			            <div class="mui-media-body">
			               <h4 id="uname">姓名</h4>
			               <p id="utext">暂无信息</p>
			            </div>
			        </a>
			    </li>
			</ul>
			<ul class="mui-table-view mui-table-view-chevron" >
				<li class="mui-table-view-cell" position='0'>
					<a class="mui-navigate-right" open-type="common">
						<span class="mui-icon iconfont icon-qun app-icon"></span> 群
					</a>
				</li>
				<li class="mui-table-view-cell" position='1'>
					<a class="mui-navigate-right" open-type="common">
						<span class="mui-icon iconfont icon-qun app-icon"></span> 群资料
					</a>
				</li>
				<li class="mui-table-view-cell" position='2'>
					<a class="mui-navigate-right" open-type="common">
						<span class="mui-icon iconfont icon-ruqun record-icon"></span> 申请加入群
					</a>
				</li>
			</ul>
			<ul class="mui-table-view mui-table-view-chevron ">
				<li class="mui-table-view-cell" position='3'>
					<a class="mui-navigate-right">
						<span class="mui-icon iconfont icon-xinxiaoxi set-icon"></span> 新消息
					</a>
				</li>

				<li class="mui-table-view-cell" position='4'>
					<a class="mui-navigate-right">
						<span class="mui-icon iconfont icon-kongjian about-icon"></span> 我的空间
					</a>
				</li>
				<li class="mui-table-view-cell" position='5'>
					<a class="mui-navigate-right">
						<span class="mui-icon iconfont icon-kongjian about-icon"></span> 积分
					</a>
				</li>
			</ul>
			<ul class="mui-table-view mui-table-view-chevron" >
				<li class="mui-table-view-cell" position='6'>
					<a class="mui-navigate-right">
						<span class="mui-icon iconfont icon-shezhi about-icon"></span> 设置
					</a>
				</li>
				<li class="mui-table-view-cell" position='7'>
					<a class="mui-navigate-right">
						<span class="mui-icon iconfont icon-about about-icon"></span> 关于
					</a>
				</li>
			</ul>
		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/libs/myStorage/myStorage.js"></script>
		<script src="../js/storageKeyName.js"></script>
		<script src="../js/utils/events.js"></script>
		<script type="text/javascript" charset="utf-8">
			mui.init({
				keyEventBind: {
					backbutton: false,
					menubutton: false
				}
			});
			//获得侧滑主窗口webview对象
			var main = null;
			var personalInfo = null;
			mui.plusReady(function() {
				main = plus.webview.currentWebview().opener();
				//获取个人信息
				personalInfo = window.myStorage.getItem(window.storageKeyName.PERSONALINFO);
				console.log(JSON.stringify(personalInfo))

				//展示个人信息
				setInfo(personalInfo)
					//				events.jumpPage(document.getElementById('title'),'mine/account-info.html');
					//点击title跳转到账号信息界面
				events.addTap('title', function() {
					closeMenu()
					events.openNewWindow('mine/account-info.html')
				})

				mui('.mui-table-view').on('tap', '.mui-table-view-cell', function() {
					console.log('click position:' + this.getAttribute('position'))		
					closeMenu();
					switch(parseInt(this.getAttribute('position'))) {
						//群
						case 0:
							events.openNewWindow('/html/mine/qun_manage.html');
							break;
							//群资料
						case 1:
							events.openNewWindow('/html/mine/qun_data.html');
							break;
							//申请加入群
						case 2:
							break;
							//新消息
						case 3:
							break;
							//我的空间
						case 4:
							break;
							//积分
						case 5:
							break;
							//设置
						case 6:
							break;
							//关于
						case 7:
						events.openNewWindow('mine/group-info.html')
						break;

						default:
							break;
					}
				
				});
			})

			/**
			 * @param {Object} info
			 * "utid":"3",
			 * "token":"Pc7Grc0gP7SacraGNpYpdDMrI9w=",
			 * "uid":"18906444490","uname":
			 * "testA0000055B6AE73",
			 * "unick":"",
			 * "usex":"0",
			 * "utxt":"",
			 * "uimg":""}
			 */
			function setInfo(info) {
				if(info.uimg) {
					document.getElementById('uimg').src = info.uimg;
				}
				if(info.uname) {
					document.getElementById('uname').innerText = info.uname;
				}
				if(info.utxt) {
					document.getElementById('utext').innerText = info.utxt;
				}

			}
			//关闭
			function closeMenu() {
				mui.fire(main, "menu:close");
			}
			//优化显示出来的侧滑菜单，只需监听该菜单的左滑事件，然后将其关闭即可；在菜单上右滑，不做任何操作；
			window.addEventListener("swipeleft", closeMenu);
			//android菜单按钮
			mui.menu = closeMenu;
			//android系统返回键
			mui.back = closeMenu;
		</script>
	</body>

</html>
