<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link href="../../css/utils/common.css" rel="stylesheet" />
		<link href="../../css/show/show-list.css" rel="stylesheet" />
	</head>

	<body>
		<!--下拉刷新容器-->
		<div id="show-all" class="mui-content mui-fullscreen mui-scroll-wrapper">
			<div class="mui-scroll">
				<!--数据列表-->
				<div v-show="listData.length>0" class=" show-list">
					<div v-for="cardData of listData" class="mui-table-view cityNews-container">
						<li v-for="(item,index) of cardData" class="mui-table-view-cell news-container" v-on:tap="jumpToPage(item)">
							<div class="img-container news-img" v-bind:style="{'background-image':'url('+getBackImg(item,index)+')','background-position':'center','background-size':'cover'}">
							</div>
							<div class="news-words">
								<p class="news-title single-line">{{item.MsgTitle}}</p>
								<div class="anthor-date">
									<p class="news-anthor single-line">{{item.unick}}</p>
									<p class="news-date">{{item.PublishDate}}</p>
								</div>
							</div>
						</li>
					</div>
				</div>
			</div>
		</div>
		<script src="../../js/mui.js"></script>
		<script src="../../js/utils/events.js" type="text/javascript"></script>
		<script src="../../js/utils/vue.js"></script>
		<script src="../../js/show/show-all.js"></script>

		<script src="../../js/publicProtocol.js"></script>
		<script src="../../js/show/show-list.js"></script>
		<script type="text/javascript">
			var showCity = {
				pageFlag: 1, //全部
				acode: 1,
				aname: '全部',
				aflag: 1, //0为根据省市编码获取数据，1为获取关注的人的列表
				pageIndex: 1,
				totalPage: 0
			};
			mui.init({
				keyEventBind: {
					backbutton: false //关闭back按键监听
				},
				pullRefresh: {
					container: '#show-all',
					down: {
						style: 'circle',
						offset: '50px',
						callback: pulldownRefresh
					},
					up: {
						contentrefresh: '正在加载...',
						callback: pullupRefresh
					}
				}
			});

			function pulldownRefresh() {
				showCity.pageIndex = 1;
				show_list.getShowList(showCity, function(showCity, data) {
					console.log('获取的关注数据：', data);
					showAll.addData(showCity.pageIndex, data);
					showCity.pageIndex++;
					mui('#show-all').pullRefresh().endPulldown();
				})
			}

			function pullupRefresh() {
				console.log("上拉加载更多")
				show_list.getShowList(showCity, function(showCity, data) {
					console.log('获取的关注数据：', data);
					showAll.addData(showCity.pageIndex, data);
					showCity.pageIndex++;
					mui('#show-all').pullRefresh().endPullupToRefresh();
				})
			}
			mui.plusReady(function() {
				show_list.getShowList(showCity, function(showCity, data) {
					console.log('获取的关注数据：', data);
					showAll.addData(showCity.pageIndex, data);
					showCity.pageIndex++;
				})
				setListener();
			})
			function setListener(){
				window.addEventListener("detailReady",function(){
					console.log("获取监听事件 detailReady");
					showAll.detailReady=true;
				})
			}
		</script>
	</body>

</html>